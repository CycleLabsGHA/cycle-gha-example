name: GitHub Actions Demo

on:
  push:

jobs:
  Explore-GitHub-Actions:
    runs-on: self-hosted
    steps:
      - name: Use a secret
        env:
          CI_CYCLE_AUTH: ${{ secrets.CI_CYCLE_AUTH }}
          CI_CYCLE_AUTH_SECRET: ${{ secrets.CI_CYCLE_AUTH_SECRET }}
        run: echo "My secret value is $CI_CYCLE_AUTH"
      
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      
      - run: echo "üñ•Ô∏è This job is now running on a self-hosted Windows runner!"
      
      - name: Check out repository code
        uses: actions/checkout@v4
      
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      
      - name: List files in the repository
        run: Get-ChildItem -Path ${{ github.workspace }}
      
      - name: Use a secret
        env:
          MY_SECRET: ${{ secrets.MY_SECRET_NAME }}
        run: echo "My secret value is $MY_SECRET"
      
      - name: Get Cycle-CLI version
        run: cycle-cli.exe -v
      
      - name: Run API Test
        run: cycle-cli --clientid $CI_CYCLE_AUTH --client-credential $CI_CYCLE_AUTH_SECRET -p ${WORKSPACE}\\${CI_CYCLE_PROJECT}\\${CI_CYCLE_PROJECT_FILE} -u ${CI_CYCLE_USER} --skip-initial-purge "${WORKSPACE}\\${CI_CYCLE_PROJECT}\\features\\api-test.feature"
      
      - run: echo "üçè This job's status is ${{ job.status }}."
