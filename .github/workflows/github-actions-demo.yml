name: Using GitHub Actions to run Cycle features!

on:
  push:

jobs:
  Run-Cycle-Feature-POC:
    runs-on: self-hosted
    steps:
      - name: Use a secret
        env:
          CI_CYCLE_AUTH: ${{ secrets.CI_CYCLE_AUTH }}
          CI_CYCLE_AUTH_SECRET: ${{ secrets.CI_CYCLE_AUTH_SECRET }}
        run: echo "My App ID is $CI_CYCLE_AUTH"
      
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      
      - run: echo "üñ•Ô∏è This job is now running on a self-hosted Windows runner!"
      
      - name: Check out repository code
        uses: actions/checkout@v4
      
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      
      - name: List files in the repository
        run: Get-ChildItem -Path ${{ github.workspace }}
      
      - name: Get Cycle-CLI version
        run: cycle-cli.exe -v
      
      - name: Run API Test
        run: cycle-cli --clientid ${{ secrets.CI_CYCLE_AUTH }} --client-credential ${{ secrets.CI_CYCLE_AUTH_SECRET }} -p automated-regression-testing.cycproj -u cyclejenkinsuser.cycuser --skip-initial-purge features/api-test-updated.feature
      
      - name: Run Browser Test
        run: cycle-cli --clientid ${{ secrets.CI_CYCLE_AUTH }} --client-credential ${{ secrets.CI_CYCLE_AUTH_SECRET }} -p automated-regression-testing.cycproj -u cyclejenkinsuser.cycuser --skip-initial-purge features/grocer.feature
        
      - run: echo "üçè This job's status is ${{ job.status }}."
